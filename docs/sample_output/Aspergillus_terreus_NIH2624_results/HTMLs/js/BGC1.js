const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const height = canvas.height;
const center = height/2;
const canvasWidth = 800;

BGClen = 51374;

geneList = [{locus_tag: "ATEG_09960 / 1...1733 (-)", protein_type: "cytochrome P450 monooxygenase", start: 1, end: 1733, strand: "-", aaseq: "MTVDALTQPHHLLSLAWNDTQQHGSWFAPLVTTSAGLLCLLLYLCSSGRRSELPVFNPKTWWELTTMRAKRDFDANAPSWIESWFSQNDKPIRFIVDSGYCTILPSSMADEFRKMKELCMYKFLGTDFHSHLPGFDGFKEVTRDAHLITKVVMNQFQTQAPKYVKPLANEASGIITDIFGDSNEWHTVPVYNQCLDLVTRTVTFIMVGSKLAHNEEWLDIAKHHAVTMAIQARQLRLWPVILRPLVHWLEPQGAKLRAQVRRARQLLDPIIQERRAERDSCLAKGIEPPRYVDSIQWFEDTAKGKWYDAAGAQLAMDFAGIYGTSDLLIGGLVDIVRHPHLLEPLRDEIRTVIGQGGWTPASLYKLKLLDSCLKESQRVKPVECATMRSYALQDVTFSNGTFIPKGELVAVAADRMSNPEVWPEPAKYDPYRYMRLREDPAKAFSAQLENTNGDHIGFGWHPRACPGRFFASKEIKMMLAYLLIRYDWKVVPNEPLQYYRHSFSVRIHPTTKLMMRRRDEDIRLPGSL", aalen: "528", color: "#FF8AD8", domain: "–", homologue: "cytochrome P450 monooxygenase LovA (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00278.html' target='_blank'>FBGC00278</a>); identity: 100.0%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF00067' target='_blank'>p450</a>",},{locus_tag: "ATEG_09961 / 2216...11780 (+)", protein_type: "highly reducing polyketide synthase, condensation domain", start: 2216, end: 11780, strand: "+", aaseq: "MAQSMYPNEPIVVVGSGCRFPGDANTPSKLWELLQHPRDVQSRIPKERFDVDTFYHPDGKHHGRTNAPYAYVLQDDLGAFDAAFFNIQAGEAESMDPQHRLLLETVYEAVTNAGMRIQDLQGTSTAVYVGVMTHDYETVSTRDLENIPTYSATGVAVSVASNRISYFFDWHGPSMTIDTACSSSLVAVHLAVQQLRTGQSSMAIAAGANLILGPMTFVLESKLSMLSPSGRSRMWDAGADGYARGEAVCSVVLKTLSQALRDGDTIECVIRETGVNQDGRTTGITMPNHSAQEALIKATYAQAGLDITKAEDRCQFFEAHGTGTPAGDPQEAEAIATAFFGHEQVARSDGNERAPLFVGSAKTVVGHTEGTAGLAGLMKASFAVRHGVIPPNLLFDKISPRVAPFYKNLRIPTEATQWPALPPGQPRRASVNSFGFGGTNAHAIIEEYMEPEQNQLRVSNNEDCPPMTGVLSLPLVLSAKSQRSLKIMMEEMLQFLETHPEIHLHDLTWSLLRKRSVLPFRRAIVGHSHETIRRALEDAIEDGIVSSDFTTEVRGQPSVLGIFTGQGAQWPGMLKNLIEASPYVRSIVRELDDSLQSLPEKYRPSWTLLDQFMLEGEASNVQYASFSQPLCCAVQIVLVRLLEAARIRFTAVVGHSSGEIACAFAAGLISASVAIRIAYLRGVVSAGGARGTPGAMLAAGMSFEEAQEICELDAFEGRICVAASNSPDSVTFSGDANAIDHLKSMLEDESTFARLLRVDTAYHSHHMLPCADPYMQALEECGCAVADAGSPAGSVPWYSSVNAENRQMAARDVTAEYWKDNLVSPVLFSHAVQRAVVTHKALDIGIEVGCHPALKSPCVATIKDVLSGVDLAYTGCLERGKNDLDTFSRALAYLWERFGASSFDADEFMRAVAPDRPCMSVSKLLPAYPWDHSRRYWVESRATRHHLRGPKPHLLLGKLSEYSTPLSFQWLNFVRPRDIEWLDGHALQGQTVFPAAGYIVMAMEAALMIAGTHAKQVQLLEILDMSIDKAVIFDDEDSLVELNLTADVSRNAGEAGSMTISFKIDSCLSKEGNLSLSAKGQLALMIGDVNSRTTSASDQHHLPPPEEEHPHMNRVNIKAFYHELGLMGYNYSKDFRRLHNMQRADLRASGTIDFIPLMDEGNGCPLLLHPASLDVAFQTVIGAYSSPGDRRLRCLYVPTHVDRITLVPSLCLATAESGCEKVAFNTINTYDKGDYLSGDIAVFDAEQTTLFQVENITFKPFSPPDASTDHAMFARWSWGPLTPDSLLDNPEYWATAQDKEAIPIIERIVYFYIRSFLNQLTLEERQKAAFHLQKQIEWLEQVLASAKEGRHLWYDPGWENDTEAQIEHLCTANSYHPHVRLVQRVGQHLLPTVRSNGNPFDLLDHDGLLTEFYTNTLSFGPALHYARELVAQIAHRYQSMDILEIGAGTGGATKYVLATPQLGFNSYTYTDISTGFFEQAREQFAPFEDRMVFEPLDIRRSPAEQGFETHAYDLIIASNVLHATPDLEKTMAHARSLLKPGGQMVILEITHKEHTRLGFIFGLFADWWAGVDDGRCTEPFVSFDRWDAILKRVGFSGVDSRTTDRDANLFPTSVFSTHAIDATVEYLDAPLASSGTVKDSYPPLVVVGGQTPKSQRLLNDIKAIMPPRPLQTYKRLVDLLDAEELPMKSTFVMLTELDEELFAGLTEETFEATKLLLTYSSNTVWLTENAWVQHPHQASTIGMLRSIRREHPDLGVHVLDVDAVETFDATFLVEQVLRLEEHTDELASSTTWTQEPEVSWCKGRPWIPRLKRDLARNNRMNSSRRPIYEMIDSSRAPVALQTAPDSSSYFLESAETWFVPESVRQMETKTVYVHFSCPHALRVGQLGFFYLVQGHVQEGNREVPVVALAERNASIVHVRPDYIYTEADNNLSEGGGSLIVTVLAAAVLAETVISTAKSLGVTDSILVLNPPSICGQMLLHAGEEIGLQVHLATTSGNRSSVSAGDAKSWLTLHARDTDWHLRRVLPRGVQAFVDLSADQSCECLTQRMMKVLMPGCAHYRAADLFTDTVSTELHRGLRHQASLPAAYWEHVVSLARQGLSSVSEGWEVMPCTQFAAHADKTRPDLSTVISWPRESDKATLPTRVRSIDAETLFAADKTYLLVGLTGDLGRSLGRWMVQHGACHIVLTSRNPQVNPKWLAHVEELGGRVTVLSMDVTSENSVDAGLAKIKDLHLPPVGGIAFGPLVLQDVMLKNMELPMMEMVLNPKVEGVRILHEKFSDPTSSNPLDFFVMFSSIVAVMGNPGQANYSAANCYLQALAQQRVASGLAASTIDIGAVYGVGFVTRAELEEDFNAIRFMFDSVEEHELHTLFAEAVVAGRRAVHQQEQQRKFATVLDMADLELTTGIPPLDPALKDRITFFDDPRIGNLKIPEYRGAKAGEGAAGSKGSVKEQLLQATNLDQGVDSLGAVTVGTWFSKQLYLDLPLLKVLGGASIADLADEAAARLPPSSIPLVAATDGGAESTDNTSENEVSGREDTDLSAAATITEPSSADEDDTEPGDEDVPRSHHPLSLGQEYSWRIQQGAEDPTVFNNTIGMFMKGPIDLKRLYKALRAVLRRHEIFRTGFANVDENGMAQLVFGQTKNKVQTIQVSDRAGAEEGYRQLVQTRYNPAAGDTLRLVDFFWGQDDHLLVVAYHRLVGDGSTTENIFVEAGQLYDGRSLSPRVPQFADLAARQRAMLEDGRMEEDLAYWKEMHQRPSSIPVLPLMRPLVGNSSTSNTPNFQHCGSWQQHEAVARLDPMVAFRIKERSRKHKATPMQFYLAAYQVLLARLTDSTDLTVGLADTNRATVDEMAAMGFFANLLPLRFRDFRPHITFGEHLIATRDLVREALQHARVPYGVLLDQLGLEVPVPTSNQPAPLLQAVFDYKQGQAESGTIGGAKITEVIATRERTPYDVVLEMSDDPTKDPLLTAKLQSSRYEAHHPQAFLESYMSLLSMFSMNPALKLA", aalen: "3004", color: "#FF0000", domain: "KS-AT-DH-MT-KR-ACP-C", homologue: "polyketide synthase LovB (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00278.html' target='_blank'>FBGC00278</a>); identity: 100.0%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='http://smart.embl.de/smart/do_annotation.pl?DOMAIN=SM00825' target='_blank'>PKS_KS</a>, <a class='funbgcs' href='http://smart.embl.de/smart/do_annotation.pl?DOMAIN=SM00827' target='_blank'>PKS_AT</a>, <a class='funbgcs' href='protfam.html#fPKS_DH' target='_blank'>fPKS_DH</a>, <a class='funbgcs' href='protfam.html#PKS_NRPS_MT' target='_blank'>PKS_NRPS_MT</a>, <a class='funbgcs' href='protfam.html#fPKS_KR' target='_blank'>fPKS_KR</a>, <a class='funbgcs' href='protfam.html#ACP_PCP' target='_blank'>ACP_PCP</a>, <a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF00668' target='_blank'>Condensation</a>",},{locus_tag: "ATEG_09962 / 12014...12784 (-)", protein_type: "hydrolase", start: 12014, end: 12784, strand: "-", aaseq: "MRYQASPALAKAPRALLCIHGAGCSPAIFRVQLSKLRAALREDFEFVYVTAPFPSSAGPGILPVFADLGPYYSWFESSSGNNNNGPSVGERLAAVHDPIRRTIVDWQTQHPHIPIVGAIGFSEGALVTTLLLWQQQMGRLPWLPRMSVAMLICPWYQDEASQYMRNEVMENHDDDHDSKDTEWQEELVIRIPTLHLQGRDDFALAGSKMLVARHFSPREAQVLEFAGQHQFPNRPRDVLEVINRFRKLCVTVQTLE", aalen: "256", color: "#0096FF", domain: "–", homologue: "thioesterase LovG (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00278.html' target='_blank'>FBGC00278</a>); identity: 100.0%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF03959' target='_blank'>FSH1</a>",},{locus_tag: "ATEG_09963 / 13182...14434 (+)", protein_type: "trans-acting enoylreductase, medium-chain dehydrogenase/reductase", start: 13182, end: 14434, strand: "+", aaseq: "MGDQPFIPPPQQTALTVNDHDEVTVWNAAPCPILPRDQVYVRVEAVAINPSDTKMRGQFATPWAFLGTDYAGTVVAVGSDVTHIQVGDRVYGAQNEMCPRTPDQGAFSQYTVTRGRVWAKIPKGLSFEQAAALPAGISTAGLAMKLLGLPLPSPSADQPPAHSKPVYVLVYGGSTATATVTMQMLRLSGYIPIATCSPHNFDLAKSRGAEEVFDYRAPNLAQTIRTYTKNNLRYSLDCITNVESTTFCFAAIGRAGGHYVSLNPFPEHAATRKMVTTDWTLGPTIFGEGSTWPAPYGRPGSEEERQFGEDLWRIAGQLVEDGRLAHHPLRVVQGGFDQIKQGMELVRKGELSGEKLVVRLEGP", aalen: "363", color: "#531B93", domain: "–", homologue: "trans-acting enoylreductase LovC (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00278.html' target='_blank'>FBGC00278</a>); identity: 100.0%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='protfam.html#fPKS_ER' target='_blank'>fPKS_ER</a>, <a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF00107' target='_blank'>ADH_zinc_N</a>, <a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF13602' target='_blank'>ADH_zinc_N_2</a>",},{locus_tag: "ATEG_09964 / 14814...16207 (-)", protein_type: "beta-lactamase-like enzyme", start: 14814, end: 16207, strand: "-", aaseq: "MGSIIDAAAAADPVVLMETAFRKAVKSRQIPGAVIMARDCSGNLNYTRCFGARTVRRDECNQLPPLQVDTPCRLASATKLLTTIMALQCMERGLVDLDETVDRLLPDLSAMPVLEGFDDAGNARLRERRGKITLRHLLTHTSGLSYVFLHPLLREYMAQGHLQSAEKFGIQSRLAPPAVNDPGAEWIYGANLDWAGKLVERATGLDLEQYLQENICAPLGITDMTFKLQQRPDMLARRADQTHRNSADGRLRYDDSVYFRADGEECFGGQGVFSGPGSYMKVLHSLLKRDGLLLQPQTVDMMFQPALEPRLEEQMNQHMDASPHINYGGPMPMVLRRSFGLGGIIALEDLDGEDWRRKGSLTFGGGPNIVWQIDPKAGLCTLAFFQLEPWNDPVCRDLTRTFEHAIYAQYQQG", aalen: "413", color: "#0096FF", domain: "–", homologue: "acyltransferase LovD (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00278.html' target='_blank'>FBGC00278</a>); identity: 100.0%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF00144' target='_blank'>Beta-lactamase</a>",},{locus_tag: "ATEG_09965 / 16762...20071 (-)", protein_type: "HMG-CoA reductase", start: 16762, end: 20071, strand: "-", aaseq: "MDPVVKKPSPGGVQHRVTKGLRAIVGHACRHPIHTLLVTALTAATTHLHVLEGTYQAAHRGLAPWAKETPLNVQSFLCGSRTVTLGEASAWRWQIDDRPKVSEDGQSDFHWALVTLDLPGASVDASIPFLSNTLSEFLGAEQITPTPDSSPSPDHSALTFRVPYSQLDGFLQAVEIIPSEKEDDSWRLRSPREEGSPTSLGHWVGSSWLSFLHRVKHAETVDLVIIGLSYLAMNMTVVSLFRVMRQLGSRFWLATSVLLSGAFAFVLGLGITTTCDVPVDMLLLFEGIPYLVLTVGFEKPIQLTRAVLCVSEELRGGWQRPVPNGASSDDSRQSQLIPNIIQLAVDREGWYIVRSYLLEIGALALGAVLRPNDSLGHFCFLAAWTLLIDAILLFTFYATILCVKLEITRIRSPGGLGQVNAKHPSGIFGHKVKSTNITWWKLLTVGGFVLCHFLQLSPFFYRVMGEYMANGTLPPTAVSPFKEAANGLNEIYLTARVEGFETRVTVLPPLQYALESAGFNISATKRSTFDGVLDGLESPLGRLCLMGALVVSLVLNNHLIHAARWHAWPQARESAVPDGSSLSVPCSATAPEVCTRPPEETEALLKSNQAESLTDDELVELCLRGKIAGYSLEKTLERIAAGSSCSVTRLDAFTRAVRIRRAAVSKTPSTQNLCSGLAESLLPYRDYNYELVHGACCENVVGYLPLPLGVAGPMVIDGQALFIPMATTEGVLVASASRGCKAINAGGGATTMLKGDGMTRGPCLRFPSAQRAAEAQRWVESPLGHEVLAAAFNATSRFARLQTLTVAQAGIYLYIRFRTTTGDAMGMNMISKGVEKALEAMAAEGGFPDMHTVTLSGNFCSDKKSAAINWIGGRGKSVIAEATIPAETVRQVLKTDVDALVELNTAKNLVGSAMAGSLGGFNAHASNLVQAVFLATGQDPAQNVESSSCITTMKNIDGNLHIAVSMPSMEVGTIGGGTILEAQGAMLDLLGVRGAHATEPGANARRLARIVAAAVLAGELSTCAALAAGHLVNAHMQHNRSAGATVKK", aalen: "1048", color: "#CCCCCC", domain: "–", homologue: "HMG-CoA reductase LovR (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00278.html' target='_blank'>FBGC00278</a>); identity: 100.0%", hkg_homologue: "AFUA_2G03700; 3-hydroxy-3-methylglutaryl-coenzyme A reductase 1; 51.4% (duplicated)", human_homologue: "3-hydroxy-3-methylglutaryl-CoA reductase; 53.7% (duplicated)", pfam: "<a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF13323' target='_blank'>HPIH</a>, <a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF12349' target='_blank'>Sterol-sensing</a>, <a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF00368' target='_blank'>HMG-CoA_red</a>",},{locus_tag: "ATEG_09966 / 21361...22872 (+)", protein_type: "transcription factor", start: 21361, end: 22872, strand: "+", aaseq: "MAADQGTFTTSVTLSPVEGSRTGGILPRRAFRRSCDRCHAQKIKCTGNKEVTARAPCQRCQQAGLRCVYSERCPKRKLRPSRAADLVSADPDPCLHMSSPPVPSQSLPLDVSESHSSNTSRQFLDPPDSYDWSWTSIGTDEAIDTDCWGLSQCDGGFSCQLEPTLPDLPSPFESTVEKAPLPPVSSDIARAASAQRELFDDLSAVSQELEAILLAVTVEWPKQEIWTRASPHSPTAFPERITQRRHNMWANWLTDLHVFSLDPIGMFFNASRRLLTVLRQQAHADCHQGTLDECLRTKNLFTAVHCYILNVRILTSISELLLSQIRRTQNSHMNPWEGSRSESPSRDDTSSTSGHSSVDTIPDFSEDLPIGELFSYVDPLTHALFSACTTLHVGVQLLRENEITLGVHSAQGIAASISMSGGPGEDIARTGATNSARCEEQPTTPAARVLFMFLSDEGASQEVKSAGSRGRTIAALRRCYEDIFSLARKHKYGMLRDLNNIPP", aalen: "503", color: "#929000", domain: "–", homologue: "transcription factor LovE (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00278.html' target='_blank'>FBGC00278</a>); identity: 100.0%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='protfam.html#EqxR' target='_blank'>EqxR</a>",},{locus_tag: "ATEG_09967 / 24439...26599 (+)", protein_type: "major facilitator superfamily transporter", start: 24439, end: 26599, strand: "+", aaseq: "MTSHHSESEKPQSNTAQMQINYVTGLRLGLVVVSVTLVAFLMLLDMSIIVTAIPHITAQFHSLGDVGWYGSAYLLSSCALQPLAGKLYTLLTLKSTFLAFLGLFEIGSVLCGTARSSTMLILGRAVAGMGGSGLTNGAITILSAAAPKQQQPLLIGIMMGLSQIAIVCGPLLGGAFTQHASWRWCFYINLPIGAFATFLLLVIQIPNRLPSTSDSTTDGTNPQRKGARGVLNQLDFLGFVLFAGFAIMISLALEWGGSAYAWNSSVIIGLFCAAGVSLVLFGCWERHVGGAVAMIPISVASHRQVWCSCFFLGLFSGALLIFSYYLPIYFQAVKNVSPTMSGVYMLPGIGGQIVMAIVTGAIIGKTGYYVPWALASGILVSISAGLVSTFQPQTSTAAWVMYQFLGGIGRGCGMQTPVVAIQNALPPQTSPIGISLAMFGQTFGGSLFLTLTKLVFSNGLYSGLHQYAPTLNAQEVTAAGATGFRQVVPAPLISRVLLAYSKGVDHAFYVAVGASGATFIFAWGMGRLTWRGWRMQEKGRSE", aalen: "542", color: "#000000", domain: "–", homologue: "major facilitator superfamily transporter LovT (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00278.html' target='_blank'>FBGC00278</a>); identity: 100.0%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF07690' target='_blank'>MFS_1</a>",},{locus_tag: "ATEG_09968 / 27479...35520 (+)", protein_type: "highly reducing polyketide synthase", start: 27479, end: 35520, strand: "+", aaseq: "MTPLDAPGAPAPIAVVGMGCRFGGGATDPQKLWKLLEEGGSAWSKIPPSRFNVGGVYHPNGQRVGSCMDPQYRLILEVVYEALEAGMYYIPWFHTWVLTLHGSAAGIPLEQVSGSKTGVFAGTMYHDYQGSFQRQPEALPRYFITGNAGTMLANRVSHFYDLRGPSVSIDTACSTTLTALHLAIQSLRAGESDMAIVAGANLLLNPDVFTTMSNLGFLSPDGISYSFDSRADGYGRGEGVAAIVLKTLPHAVRDGDPIRLIVRETAINQDGRTLAISTPSGEAQERLIRDCYQKARLDPKQTSYVEAHGTGTGAGDPLELGVISAAFPRQQIQVGSVKANIGHTEAIPLSSQSWIPTDGVCRASINNFGFGGANAHAIVERYAPFAETSMCSPNGYPGNYDGHVETDQAHIYVLSAKDENSCMRMVSRLCDYATHAREADDWQLLANMAYTLGSRRSNFRWKAVCTAHNLTSLAQNLAGDGMRPSKSAEQVRLGWVFTGQGAQWFAMGQELSRPETESRVDQAEFSLPLSTALQIALVRLLWSWNIQPVAVTSHSSGEAAAAYAIGALTARSAIGISYIRGALTARDRLASVHKGAMLAVGLSRSEVGIYIRQVPLQSEECLVVGCINSPSSVTVSGDLSAIAKLEELLHADRIFARRLKVTQAFHSSHMNSMTDAFRAGLTELFGADPSDAANANKDVIYASPRTGDRMHDFNSLRDPMHWVECMLYPVEFESAFRQMCLDENDHMPKVDRIIEIGPHGALGGPIKQIMQLPELAPCDIPYLSCLSRGKSSLSTLRLLASELIRAGFPVDLNAINFPRGCEAARVQVLSDLPPYPWNHETRYWKEPRISQSARQRKGPVHDLIGLQEPLNLPLARSWHNVLRVSDLPWLRDHVVGSHIVFPGAGFVCMAVIGISTLCSSDHESADFSYILRDVNFAQALILPADGEEGIDLRLTICAPDQSLGSQDWQRFLVHSITADKNDWTEHCTGLVRVDMDQPASSLSNPQRADPRPWSRKTAPQDLWDSLHRVGIRHGPLFQNITRIESDGRESWCTFAIADTASAMPHAYESQHIVHPTTLDSAIQAAYTTLPFAGSRIKSAMVPARVGCMKISSRLADLEARDMLRAQAKMHSQSHCALVTDVAVFDEADPFGGPVMELEGLVFQSLGASLGTSGRDSTDTGNTCSSWHWAPDISLVNPVWLERTLDTGIQKHEIGVILELRRCSVHFIQEAMESLSVGDVARLSGHLAKFYAWMQAQLACAQNGELGPESSSWTRDNEHARCSLRSRVVAGSTNGEMICRLGSVLPAILRREVDPLEVMMDGHLLSRYYVDALKWSRSNAQASELVRLCCHKNPRARILEIGGGTGGCTQLVVDSLGPNPPVGRYDFTDVSAGFFEAARKRFAGWQDVMDFRKLDIEDDPEAQGFVCGSYDVVLACQVLHATSNMQRTLTNVRKLLKPGGKLILVETTRDELDLFFTFGLLPGWWLSEEPERQSTPSLSPTMWRSMLHATGFNGVEVEARDCDSDEFYMISTMMSTAVQATPTSCSDKLPEVLLVYVDSSTPMSWISDLQGAIRCRNCSVTSLQALRQVPPTEGQMCVFLGEMEHSMLGSVTNDDFTLLTSMLQLAGGALWVTRGATMKSDDPLKALHLGLLRTMRNESHGKRFVSLDLDPSRNPWTGDSRDAIVSVLDLVSMSDEKEFDYAERGGVIHVPRAFSDSINGGEEDGYALEPFQDSQHLLRLDIRTPGLLDSLYFRKRSVDPYEPDKLPDDWVEIEPRAFGLNFRDIMVAMGQLESNVMGFECAGVVTSLSETARTIAPGLAVGDRVCALMNGHWASRVTTSRTNVVRIPETLSFPHAASIPLAFTTAYISLYTVARILPGETVLIHAGAGGVGQAAIILAQLTGAEVFTTAGSEAKRNHLIDKFHLDPDHVFSSRDSSFVDGIKTRTSGKGVDVVLNSLAGPLLQKSFDCLARFGRFVEIGKKDLEQNSRLDMSTFVRNVSFSSVDILYWQQAKSAEIFQALSEVILLWGRTAIGLIHPISEYPMSALEKAFRTMQSGQHVGKIVVTVAPDDAVLVRQERMPLFLKPNVSYLVAGGLGGIGRRICEWLVDRGARYLIILSRTARVDPVVTSLQERGCTVSVQACDVADKSQLEAALQQCRAENLPPIRGVIQGAMVLKDALVSQMTADGFHAALRPKVQGSWNLHRIASDVDFFVMLSSLVGVMGGAGQANYAAAGAFQDALAEHRMAHNQPAVTIDLGMVQSIGYVAETDSAVAERLQRIGYQPLHEEEVLAVLEQAMSPVCSPTAPTRPAVIVTGINTRPGPHWAHADWMQEARFAGIKYRDPLRDNNGALPLTLAEDDNLHARLNRATSQQASIAVIMEAMGRKLISMFGLTDSEMSATQTLAGIGVDSLVAIELRNWITARFNVDISVFELMEGRTIAKVAEVVLQRYKP", aalen: "2452", color: "#FF0000", domain: "KS-AT-DH-MT-ER-KR-ACP", homologue: "polyketide synthase LovF (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00278.html' target='_blank'>FBGC00278</a>); identity: 95.3%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='http://smart.embl.de/smart/do_annotation.pl?DOMAIN=SM00825' target='_blank'>PKS_KS</a>, <a class='funbgcs' href='http://smart.embl.de/smart/do_annotation.pl?DOMAIN=SM00827' target='_blank'>PKS_AT</a>, <a class='funbgcs' href='protfam.html#fPKS_DH' target='_blank'>fPKS_DH</a>, <a class='funbgcs' href='protfam.html#PKS_NRPS_MT' target='_blank'>PKS_NRPS_MT</a>, <a class='funbgcs' href='protfam.html#fPKS_ER' target='_blank'>fPKS_ER</a>, <a class='funbgcs' href='protfam.html#fPKS_KR' target='_blank'>fPKS_KR</a>, <a class='funbgcs' href='protfam.html#ACP_PCP' target='_blank'>ACP_PCP</a>",},{locus_tag: "ATEG_09969 / 36974...39452 (-)", protein_type: "transcription factor", start: 36974, end: 39452, strand: "-", aaseq: "MESAELSSKRQAFPACDECRIRKVRCSKEGSKCSHCLRYNLPCEFSNKVTRVNQTAKLARDVEKLGSRVEDIEHALQRCLSFIDAHQGFRDLSRPQSQESGYTSSTSSEECEVNLYSGKHTSPTEEDGFWPLHGYGSFVSLVMEAQAANANLTSWLPVDMNSHQVAEMVAFDHQAVSAVRSKVTEANETLQQIIDDIPTLSASEDDTFLPSLPPRALVEPSINEYFKKLNPRLPIFSRQTIRDAVESQYTIRTGPPDLVWITSFNCIVLQALTQTSIANKVVGGTEQDIPLDYMIISLLRNIRQCYNRLETLVKPRLSNIRALFCLALVAMEYFDFAIFQTIFAQVCELSRLIGLHLMTTTPPTEDGAVDDQPKDLFWSIFLVDKHVSIIGGKACLLPSYDCSVPLPPYDSAAPLPNVFAARIRLAFILEEIYQCLYSAKSSKMEQSRVRRRIRRIARKLSQWHVQHEHVLRTGDSKRPLEEYICAMQLRFALSSCWVLLHKRIWSQERGTVCLQHARDCLMLFKQLCDGCKSGFSNFDSIVLNYSLISFMGIYVHIVEEDQPIHSQDMEILTFFAIYTNRLASNRSAASIPYKFSQVASRCSDIALLLQNLRERRFIPTTISRSPTPSWNEPTYMDYDAANASTSTTSTGSSYNLNIGPLGVPGDGQVWDIYFNPREIPMDGTIATPSEDATQDLLSNEAGQCLDFPDFSLGIDNFPDFPLGIDMTSQSEFDLIMEEDIIRYKRLLDRPV", aalen: "751", color: "#929000", domain: "–", homologue: "transcription factor LovH (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00278.html' target='_blank'>FBGC00278</a>); identity: 100.0%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='protfam.html#EqxR' target='_blank'>EqxR</a>, <a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF04082' target='_blank'>Fungal_trans</a>",},{locus_tag: "ATEG_09970 / 41209...42507 (-)", protein_type: "mitochondrial carrier protein", start: 41209, end: 42507, strand: "-", aaseq: "MDSKIQTNVPLPKAPLIQKARGKRTKGIPALVAGACAGAVEISITYPFESAKTRAQLKRRNHDVAAIKPGIRGWYAGYGATLVGTTVKASVQFASFNIYRSALSGPNGELSTGASVLAGFGAGVTEAVLAVTPAEAIKTKIIDARKVGNAELSTTFGAIAGILRDRGPLGFFSAVGPTILRQSSNAAVKFTVYNELIGLARKYSKNGEDVHPLASTLVGSVTGVCCAWSTQPLDVIKTRMQSLQARQLYGNTFNCVKTLLRSEGIGVFWSGVWFRTGRLSLTSAIMFPVYEKVYKFLTQPN", aalen: "301", color: "#000000", domain: "–", homologue: "tricarboxylate transporter Fum11 (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00064.html' target='_blank'>FBGC00064</a>); identity: 43.2%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF00153' target='_blank'>Mito_carr</a>",},{locus_tag: "ATEG_09971 / 43197...44725 (+)", protein_type: "2-methylcitrate dehydratase", start: 43197, end: 44725, strand: "+", aaseq: "MTKQSADSNAKSGVTAEICHWASNLATDDIPSDVLERAKYLILDGIACAWVGARVPWSEKYVQATMSFEPPGACRVIGYGQKLGPVAAAMTNSAFIQATELDDYHSEAPLHSASIVLPAVFAASEVLAEQGKTISGIDVILAAIVGFESGPRIGKAIYGSDLLNNGWHCGAVYGAPAGALATGKLLGLTPDSMEDALGIACTQACGLMSAQYGGMVKRVQHGFAARNGLLGGLLAYGGYEAMKGVLERSYGGFLKMFTKGNGREPPYKEEEVVAGLGSFWHTFTIRIKLYACCGLVHGPVEAIEKLQRRYPELLNRANLSNIRHVYVQLSTASNSHCGWIPEERPISSIAGQMSVAYILAVQLVDQQCLLAQFSEFDDNLERPEVWDLARKVTPSHSEEFDQDGNCLSAGRVRIEFNDGSSVTETVEKPLGVKEPMPNERILHKYRTLAGSVTDESRVKEIEDLVLSLDRLTDITPLLELLNCPVKSPLV", aalen: "490", color: "#C4C35F", domain: "–", homologue: "aconitate decarboxylase OryM (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00517.html' target='_blank'>FBGC00517</a>); identity: 54.6%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF03972' target='_blank'>MmgE_PrpD</a>, <a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF19305' target='_blank'>MmgE_PrpD_C</a>",},{locus_tag: "ATEG_09972 / 45998...47389 (-)", protein_type: "major facilitator superfamily transporter", start: 45998, end: 47389, strand: "-", aaseq: "MGHGDTESPNPTTTTEGSGQNEPEKKGRDIPLWRKCVITFVVSWMTLVVTFSSTCLLPAAPEIANEFDMTVETINISNAGVLVAMGYSSLIWGPMNKLVGRRTSYNLAISMLCACSAGTAAAINEEMFIAFRVLSGLTGTSFMVSGQTVLADIFEPVYRGTAVGFFMAGTLSGPAIGPCVGGVIVTFTSWRVIFWLQLGMSGLGLVLSLLFFPKIEGNSEKVSTAFKPTTLVTIISKFSPTDVLKQWVYPNVFLADLCCGLLAITQYSILTSARAIFNSRFHLTTALVSGLFYLAPGAGFLIGSLVGGKLSDRTVRRYIVKRGFRLPQDRLHSGLITLFAVLPAGTLIYGWTLQEDKGDMVVPIIAAFFAGWGLMGSFNCLNTYVAGLFHTLIYLFPLCTCPQ", aalen: "403", color: "#000000", domain: "–", homologue: "major facilitator superfamily transporter Orf6 (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00213.html' target='_blank'>FBGC00213</a>); identity: 28.2%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF07690' target='_blank'>MFS_1</a>",},{locus_tag: "ATEG_09973 / 49687...51374 (-)", protein_type: "cytochrome P450 monooxygenase", start: 49687, end: 51374, strand: "-", aaseq: "MTLQIIVIAATAVIYFLTRYFNRTDIPKIKGIPEIPGVPIFGNLIQLGVKHATVARKWSKKFGPVFQARLGNRRVIFANTFESTRQLWIKEQSSMISRPTFHTFHGVVSSSQGFTIGTSPWDESCKRRRKAAATALNRVAVQSYMPIIDLESMASIKELLKDSQGGKIDINPTPYFQRFALNTSLTLNYGYRIEGNVNDQLLREICEVQRGVANLRSTSNNWQDYVPLLRLFSDRSNQAKHLRGRRDKYMAFLFDILKDRMAKGTDKPCITGNILKNPETKLTDAEIKSICLTMVSAGLDTVPGNLIMGIAYLSSEDGQRIQQKAYEEIMSVYPNGDAWERCLVEEKVPYITALVKETLRFWTVMPICIPRVNIKEIVYNGARIPAGTTFFMNAWAANYDEDHFDMPNRFLPERYLEPSEGFGTPHYSFGAGTRMCAASHLASRELYTVFLRFIVAFTIEPAQNPADMPVLDAIECNATPTSMTTEPKPFKVGFKPRDEASLRRWIAESEERTKEL", aalen: "516", color: "#FF8AD8", domain: "–", homologue: "cytochrome P450 monooxygenase CYP3 (<a class='funbgcs' href='http://staffweb1.cityu.edu.hk/ymatsuda/funbgcs/funbgcs/FBGC00097.html' target='_blank'>FBGC00097</a>); identity: 43.9%", hkg_homologue: "–", human_homologue: "–", pfam: "<a class='funbgcs' href='http://www.ebi.ac.uk/interpro/entry/pfam/PF00067' target='_blank'>p450</a>",},];



// Draw a background line
ctx.beginPath();
ctx.moveTo(0, center);
ctx.lineTo(canvasWidth, center);
ctx.stroke();


function DrawArrow(start_ori, end_ori, BGClen, strand, center, height, color, locus_tag, protein_type, aalen, aaseq, domain, homologue, hkg_homologue, human_homologue, pfam) {
  const start = start_ori * canvasWidth / BGClen;
  const end = end_ori * canvasWidth / BGClen;
  const arrowHeadSize = Math.log(end - start) * 3;
  if (strand === "+") {
    const arrowHeadStart = end - arrowHeadSize;
    ctx.beginPath();
    ctx.moveTo(start, center - height / 4);
    ctx.lineTo(arrowHeadStart, center - height / 4);
    ctx.lineTo(arrowHeadStart, center - height / 2);
    ctx.lineTo(end, center);
    ctx.lineTo(arrowHeadStart, center + height / 2);
    ctx.lineTo(arrowHeadStart, center + height / 4);
    ctx.lineTo(start, center + height / 4);
    ctx.fillStyle = color;
    ctx.closePath();
    ctx.fill();
    if (
      (hkg_homologue !== "–" && hkg_homologue.includes("duplicated")) ||
      (human_homologue !== "–" && human_homologue.includes("duplicated"))
    ) {
      ctx.fillStyle = "#CCFFFF";
      ctx.fill();
      ctx.strokeStyle = "#005493";
      ctx.lineWidth = 2;
      ctx.stroke();
    }

  } else if (strand === "-") {
    const arrowHeadStart = start + arrowHeadSize;
    ctx.beginPath();
    ctx.moveTo(end, center - height / 4);
    ctx.lineTo(arrowHeadStart, center - height / 4);
    ctx.lineTo(arrowHeadStart, center - height / 2);
    ctx.lineTo(start, center);
    ctx.lineTo(arrowHeadStart, center + height / 2);
    ctx.lineTo(arrowHeadStart, center + height / 4);
    ctx.lineTo(end, center + height / 4);
    ctx.fillStyle = color;
    ctx.closePath();
    ctx.fill()
    if (
      (hkg_homologue !== "–" && hkg_homologue.includes("duplicated")) ||
      (human_homologue !== "–" && human_homologue.includes("duplicated"))
    ) {
      ctx.fillStyle = "#CCFFFF";
      ctx.fill();
      ctx.strokeStyle = "#005493";
      ctx.lineWidth = 2;
      ctx.stroke();
    }
  };
    
  // Add click event listener to canvas
  canvas.addEventListener('click', function(event) {
    const rect = canvas.getBoundingClientRect();
    const x = event.clientX - rect.left;
    const y = event.clientY - rect.top;
    if (x >= start && x <= end && y >= center - height / 2 && y <= center + height / 2) {
      // Perform action when arrow is clicked
      document.querySelector('#position').textContent = locus_tag;
      document.querySelector('#function').textContent = protein_type;
      if (domain.includes("CT")) {
      domain = domain.replace("CT", "C<sub>T</sub>");
      }
      document.querySelector('#domain').innerHTML = domain;
      document.querySelector('#homologue').innerHTML = homologue;
      document.querySelector('#hkg_homologue').innerHTML = hkg_homologue;
      document.querySelector('#human_homologue').innerHTML = human_homologue;
      document.querySelector('#aalen').textContent = aalen;
      document.querySelector('#aaseq').textContent = aaseq;
      document.querySelector('#pfam').innerHTML = pfam;
      const blastURL = document.querySelector('#blast');
      const newURL = `https://blast.ncbi.nlm.nih.gov/Blast.cgi?PAGE_TYPE=BlastSearch&CMD=Web&LAYOUT=OneWindow&PROGRAM=blastp&PAGE=Proteins&FORMAT_TYPE=HTML&NCBI_GI=on&SHOW_OVERVIEW=on&QUERY=${aaseq}`;
      const msg = document.getElementById("message");
      if (newURL.length < 8214) {
        blastURL.href = newURL;
        msg.style.display = "none";
      } else {
        blast.href = "https://blast.ncbi.nlm.nih.gov/Blast.cgi?PAGE_TYPE=BlastSearch&CMD=Web&LAYOUT=OneWindow&PROGRAM=blastp&PAGE=Proteins&FORMAT_TYPE=HTML&NCBI_GI=on&SHOW_OVERVIEW=on";        
        msg.style.display = "block";
      }      
    }
  });
}


for(let i = 0; i < geneList.length; i++) {
  const start = geneList[i].start;
  const end = geneList[i].end;
  const strand = geneList[i].strand;
  const color = geneList[i].color
  const locus_tag = geneList[i].locus_tag
  const protein_type = geneList[i].protein_type
  const aalen = geneList[i].aalen
  const aaseq = geneList[i].aaseq
  const domain = geneList[i].domain
  const homologue = geneList[i].homologue
  const hkg_homologue = geneList[i].hkg_homologue
  const human_homologue = geneList[i].human_homologue
  const pfam = geneList[i].pfam
  DrawArrow(start,end,BGClen,strand,center,50,color,locus_tag,protein_type,aalen,aaseq,domain,homologue,hkg_homologue,human_homologue,pfam)
}

function copyToClipboard() {
  const text = document.getElementById("aaseq").innerText;
  if (text.length !== 0) {
    if (navigator.clipboard) {
      navigator.clipboard.writeText(text)
        .then(() => {
          window.alert("AA sequence copied to clipboard");
        })
        .catch((err) => {
          console.error("Failed to copy text: ", err);
        });
    } else {
      const textarea = document.createElement("textarea");
      textarea.value = text;
      document.body.appendChild(textarea);
      textarea.select();
      document.execCommand("copy");
      document.body.removeChild(textarea);
      window.alert("AA sequence copied to clipboard");
    }
  } else {
    window.alert("No gene selected!");
  }
}